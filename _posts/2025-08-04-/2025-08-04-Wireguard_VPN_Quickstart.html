---
creation_epoch: 1753748871
lastmod_epoch: 1753748871
categories: ['Tech Tricks']
title: Wireguard VPN Quickstart
---

Quickstart guide to setting up a Wireguard server as a VPN that provides masquerade NAT so clients can access the Internet via the VPN server. Tested on Ubuntu and Android.

<h2>Server</h2>

<h3>Install</h3>

<pre>
sudo apt-get update
sudo apt-get --yes install wireguard

cd /etc/wireguard/
</pre>

<h3>Prepare Keys</h3>

<pre>
cd /etc/wireguard/

mkdir server.keys/
mkdir client1.keys/
mkdir client2.keys/

cd server.keys/ && wg genkey | tee privatekey | wg pubkey > publickey && cd ..
cd client1.keys/ && wg genkey | tee privatekey | wg pubkey > publickey && cd ..
cd client2.keys/ && wg genkey | tee privatekey | wg pubkey > publickey && cd ..
</pre>

<h3>Create the server conf</h3>

<ol>
  <li>Replace the private key with server.keys/privatekey</li>
  <li>Replace the public key for each peer with the respective client#.keys/publickey</li>
  <li>I used static IP assignments for each client, but you could use dynamic if you wanted.</li>
  <li>Note that eno1 might be eth1 or something else (ip link show)</li>
</ol>

<p>vi /etc/wireguard/wg0.conf</p>
<pre>
[Interface]
PrivateKey = INSERT_SERVER.KEYS/privatekey_HERE
Address = 10.8.0.1/24
PostUp = iptables -A FORWARD -i wg0 -j ACCEPT; iptables -t nat -A POSTROUTING -o eno1 -j MASQUERADE
PostDown = iptables -D FORWARD -i wg0 -j ACCEPT; iptables -t nat -D POSTROUTING -o eno1 -j MASQUERADE
ListenPort = 51820

[Peer]
PublicKey = INSERT_CLIENT1.KEYS/publickey_HERE
AllowedIPs = 10.8.0.2/32

[Peer]
PublicKey = INSERT_CLIENT2.KEYS/publickey_HERE
AllowedIPs = 10.8.0.3/32
</pre>

<h3>Server Startup</h3>

<pre>
sudo systemctl start wg-quick@wg0
sudo systemctl enable wg-quick@wg0
</pre>

<h3>Enable Packet Forwarding</h3>

<pre>
echo "net.ipv4.ip_forward = 1
net.ipv6.conf.all.forwarding = 1" > /etc/sysctl.d/wg.conf

sysctl --system
</pre>

<h2>Client Conf</h2>

<pre>
[Interface]
Address = 10.8.0.2/32
PrivateKey = INSERT_CLIENT1.KEYS/privatekey_HERE
DNS = 1.1.1.1

[Peer]
PublicKey = INSERT_SERVER.KEYS/publickey_HERE
Endpoint = INSERT_YOUR_IP_OR_DNS_HERE:51820
AllowedIPs = 0.0.0.0/0, ::/0
</pre>
